# CLAUDE.md — 智链OS 工作规范

## 工作流编排

### 1. 计划节点（默认）
- 对任何非平凡的任务（3个步骤以上或架构决策）进入计划模式
- 如果事情出现意外，立即停止并重新计划——不要继续推进
- 验证步骤使用计划模式，而不仅仅是构建
- 提前编写详细规格以减少模糊性

### 2. 子代理策略
- 大量使用子代理以保持主上下文窗口干净
- 将研究、探索和并行分析卸载到子代理
- 对于复杂问题，通过子代理增加计算量
- 每个子代理专注于一项任务以实现集中执行

### 3. 自我提升循环
- 用户进行任何纠正后：使用该模式更新 `tasks/lessons.md`
- 为自己制定规则，防止重复犯错
- 严格迭代这些教训，直到错误率下降
- 在会话开始时回顾相关项目课程

### 4. 完成前的验证
- 永远不要在证明其功能正常之前标记任务完成
- 在相关情况下，比较主分支和你的更改之间的差异行为
- 问自己："一个高级工程师会批准这个吗？"
- 运行测试，检查日志，证明正确性

### 5. 追求优雅（平衡）
- 对于非平凡的变更：暂停并问"有没有更优雅的方式？"
- 如果一个修复感觉很粗糙："现在回想起来，应该实现优雅的解决方案"
- 对于简单、明显的修复，跳过这一步——不要过度设计
- 在展示自己的工作之前，先挑战自己的作品

### 6. 自主性错误修复
- 当收到一个错误报告：直接修复它。不要要求别人手把手教你
- 指向日志、错误、失败的测试——然后解决它们
- 用户无需切换上下文
- 去修复失败的 CI 测试，无需被告知如何做

---

## 任务管理

1. **先计划**：将计划写入 `tasks/todo.md`，包含可勾选的项目
2. **验证计划**：在开始实施前进行检查
3. **跟踪进度**：随着进展标记项目完成
4. **解释变更**：每一步的高级概述
5. **文档结果**：在 `tasks/todo.md` 中添加评论部分
6. **总结经验**：在修正后更新 `tasks/lessons.md`

---

## 核心原则

- **优先简洁**：让每一次变更尽可能简单。影响最少的代码。
- **拒绝懒惰**：寻找根本原因。不接受临时修复。遵循高级开发者的标准。
- **最小化影响**：变更只应触及必要部分。避免引入错误。

---

## 项目结构参考

```
tasks/
  todo.md      # 当前任务清单（可勾选）
  lessons.md   # 经验教训积累
```
